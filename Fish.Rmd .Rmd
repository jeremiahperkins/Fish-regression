---
title: "Fish Analysis and Regression"
name: Jeremiah Perkins
output:
  html_document: default
  word_document: default
---


**Introduction**


This is my report of an Exploratory Data Analysis and Regression of a Fish dataset I obtained from Kaggle. We began by installing packages and loading them into R. We then do a quick summary of the data to see how the data is distributed. Since we are dealing with numerical data most of our graphs will be scatter plots to see how the variables work together. We will then create a correlation plot of our variables to get the correlation of all variables. Next, we continue our project by manually splitting the data into test and train sets then predicting our model on our test set. This was just to show how it can be done manually, but I use caret to run a cross validation model to get a more accurate assessment of our model and model error.



```{r, LoadPackages, include = FALSE}
library(ggiraph)
library(ggiraphExtra)
library(caret)
library(PerformanceAnalytics)
library(RColorBrewer)
library(corrplot)
library(readxl)
library(tidyverse)
library(broom)
library(rsample)
```


We began by importing some useful packages that is going to make accomplishing this project much easier. Next we are going to import our data into R from Excel using the readxl function. 


```{r, import data, echo = FALSE}
Fish <- read_excel("~/Downloads/Fish.xlsx", 
                      skip = 1)
```





The column names in this dataset are vague, so we will explain what each one means.

* Species - Species name of fish
* Weight - Weight of fish in grams
* Length1 - Vertical Length in cm
* Length2 - diagonal length in cm
* Length3 - cross length in cm
* Height - height in cm
* Width - diagonal width in cm




```{r, echo = TRUE}
head(Fish)
Fish <- Fish %>% select(-Length2)
summary(Fish)
```




The dataset had the columns names on the first row of the actual dataset. To fix this problem we simply skip the fist line  only importing the values. The diagonal length was not import to me so I remove the column from the dataset as well. Summary is a very useful function as we can quickly see min, max, and averages throughout the dataset. We see that the mean weight is 398.3 grams and mean height is 8.971 cm.  




**EDA**


```{r, echo = TRUE}
ggplot(Fish, aes(x = Weight, y = Length1, color = Species)) + geom_point() + geom_jitter(alpha = .5) 
ggplot(Fish, aes(x = Weight, y = Length3, color = Species)) + geom_point() + geom_jitter(alpha = .5)
ggplot(Fish, aes(x = Weight, y = Height, color = Species)) + geom_point() + geom_jitter(alpha = .5)
ggplot(Fish, aes(x = Weight, y = Width, color = Species)) + geom_point() + geom_jitter(alpha = .5)
ggplot(Fish, aes(x = Length1, y = Length3, color = Species)) + geom_point() + geom_jitter(alpha = .5)
ggplot(Fish, aes(x = Height, y = Width, color = Species)) + geom_point() + geom_jitter(alpha = .5)
Fish %>% count(Species) %>% mutate(Species = fct_reorder(Species, n, .desc = TRUE)) %>%
  ggplot(aes(x = Species, y = n)) + geom_bar(stat = 'identity')
ggplot(Fish, aes(x = Height, y = Weight, color = Species)) + geom_point()
```



Our data consists of weight, height, length, and width in grams and cm. This is important because we can visualize this data by creating scatter plots to see how the data works together. We also wanted to create a graph that has a count of the Species in the dataset and we can do this with a barplot. We can see that the variables have a positive correlation meaning that as one variable increases, so should the other. This is important, because we find when implementing a model this is not true for all variables. 




**Correlation Graph**
```{r, echo = TRUE}
Fish1 <- Fish[, 2:6]
chart.Correlation(Fish1, histogram = TRUE, pch = 19)
```



We wanted to see the correlations of the variables, but typing that over and over is quite tedious. Instead we create a chart that has the correlation between variables. Before we could create this chart we needed to subset the data to only include numeric columns. Weight is most closely related to Length3 with a r = .92 with Height being less correlated at r = .72! 




**Regression Model**
```{r, echo = TRUE}
set.seed(42)
Fish_split <- initial_split(Fish, prop = .75)
training_data <- training(Fish_split)
testing_data <- testing(Fish_split)
dim(training_data)
dim(testing_data)
model <- lm(Weight ~ factor(Species) + Length1 + Length3 + Height + Width, data = training_data)
Fish_predict <- predict(model, newdata = testing_data)
error <- Fish_predict - testing_data[["Weight"]]
sqrt(mean(error^2))
summary(model)
```




The goal of this project was to predict fish weight with the variables we have present in the dataset. We began our model by splitting the dataset into a train set and a test set. We next create a model using our training data to see how it will perform on unseen data (test set). Once complete, we get the error and square root it to get the root mean square error of our model. 




For those who are not familiar with regression models we can interpret it as such: For every cm increase in Length3, Weight increase by 77.386 grams. For example, let's say you want to predict the weight of a Pike fish and you only have information about the fishes Length3(cross). You can use the formula **predicted_weight = -1034.651 + 77.386(Length3)** created by R to get those results. 






**Cross Validation**
```{r, echo = TRUE}
model2 <- train(Weight ~ factor(Species) + Length1 + Length3 + Height + Width, data = Fish, method = "lm", trControl = trainControl(method = "cv", number = 10, verboseIter = TRUE))
print(model2)
Fish_predict_final <- predict(model2, Fish)
Fish_predict_dataframe <- data.frame(wgt_predicted = predict(model2, Fish))
```




What we did above was cool, but it was manual and only one test/train split. What if we wanted to do this multiple times on our dataset. Well we can use the caret package to make this much easier and it also automatically calculates RMSE and MAE. 


After creating the cross validation model (10 x 10) we predict it onto the entire dataset. To get those results we have to make sure we create a data frame so we can see the difference in predicted weight and actual weight of the fish. 




**Conclusion** 
This project attempts to predict Fish weight with the variables provided in the dataset. We stated by importing the dataset, exploratory data analysis, correlations, graphs, and finished with modeling. I hope you enjoy, any comments are greatly apperciated, and try it for yourself and see what results you obtain. _Jeremiah Perkins_



